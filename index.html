<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¯¸ì†Œì—° MMS v1.9 - ì´ˆì •ë°€ ì—‘ì…€ ë¯¸ëŸ¬ë§</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f1f5f9; }
        
        /* ì—‘ì…€ í…Œì´ë¸” ì •ë°€ ì¬í˜„ */
        .excel-container { background: #ffffff; border: 1px solid #cbd5e1; overflow: auto; max-height: 80vh; }
        .excel-table { border-collapse: collapse; min-width: 100%; table-layout: fixed; }
        .excel-table th, .excel-table td { 
            border: 1px solid #cbd5e1; 
            padding: 12px; 
            font-size: 13px; 
            line-height: 1.6;
            vertical-align: top; 
            word-break: break-all;
            white-space: pre-wrap; /* ì—‘ì…€ì˜ ì¤„ë°”ê¿ˆì„ ê·¸ëŒ€ë¡œ í‘œì‹œ */
        }
        .excel-table tr:nth-child(even) { background-color: #f8fafc; }
        .cell-content { min-height: 20px; transition: all 0.2s; }
        .clickable-cell:hover { background-color: #e2e8f0 !important; cursor: pointer; color: #2563eb; }
        
        @media print { .no-print { display: none !important; } }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState } = React;

        const MisoYonApp = () => {
            const [excelData, setExcelData] = useState([]);
            const [selectedRecipe, setSelectedRecipe] = useState(null);

            const handleFileUpload = (e) => {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = (evt) => {
                    const bstr = evt.target.result;
                    const wb = XLSX.read(bstr, { type: 'binary' });
                    const wsname = wb.SheetNames[0];
                    const ws = wb.Sheets[wsname];
                    // ì›ë³¸ ì„œì‹ì„ ìµœëŒ€í•œ ìœ ì§€í•˜ë©° ë°°ì—´ë¡œ ë³€í™˜
                    const data = XLSX.utils.sheet_to_json(ws, { header: 1, defval: "" });
                    setExcelData(data);
                };
                reader.readAsBinaryString(file);
            };

            return (
                <div className="flex flex-col min-h-screen">
                    {/* ìƒë‹¨ í—¤ë” */}
                    <header className="bg-slate-900 text-white p-5 flex justify-between items-center shadow-lg no-print">
                        <div className="flex items-center gap-4">
                            <h1 className="text-2xl font-black tracking-tighter text-blue-400">ë¯¸ì†Œì—° MMS v1.9</h1>
                            <span className="text-slate-400 text-xs font-bold border border-slate-700 px-2 py-1 rounded">ì´ˆì •ë°€ ì—‘ì…€ ëª¨ë“œ</span>
                        </div>
                        <div className="flex gap-3">
                            <label className="bg-blue-600 hover:bg-blue-500 text-white px-6 py-2 rounded-xl font-bold cursor-pointer transition flex items-center gap-2">
                                <span>ğŸ“ ì—‘ì…€ ë“±ë¡</span>
                                <input type="file" onChange={handleFileUpload} className="hidden" accept=".xlsx,.xls,.csv" />
                            </label>
                            <button onClick={() => window.print()} className="bg-slate-700 hover:bg-slate-600 px-6 py-2 rounded-xl font-bold transition">ì¸ì‡„ / PDF</button>
                        </div>
                    </header>

                    <div className="p-6 grid grid-cols-12 gap-6 flex-grow">
                        {/* ì™¼ìª½: ì—‘ì…€ ë¯¸ëŸ¬ë§ í…Œì´ë¸” */}
                        <div className="col-span-12 lg:col-span-9">
                            <div className="excel-container rounded-2xl shadow-inner">
                                {excelData.length > 0 ? (
                                    <table className="excel-table">
                                        <tbody>
                                            {excelData.map((row, i) => (
                                                <tr key={i}>
                                                    {row.map((cell, j) => (
                                                        <td 
                                                            key={j} 
                                                            className={cell ? "clickable-cell cell-content" : "cell-content"}
                                                            onClick={() => cell && setSelectedRecipe(cell)}
                                                        >
                                                            {cell}
                                                        </td>
                                                    ))}
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                ) : (
                                    <div className="py-60 text-center flex flex-col items-center justify-center bg-white">
                                        <div className="text-6xl mb-6 opacity-20">ğŸ“Š</div>
                                        <p className="text-xl font-bold text-slate-400 italic">"ì—‘ì…€ íŒŒì¼ ë“±ë¡í•˜ê¸°" ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>
                                        <p className="text-sm text-slate-300 mt-2">ì…°í”„ë‹˜ì˜ ì—‘ì…€ í™”ë©´ì´ ì—¬ê¸°ì— ê·¸ëŒ€ë¡œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.</p>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* ì˜¤ë¥¸ìª½: ìƒì„¸ ë ˆì‹œí”¼ ì •ë³´ì°½ */}
                        <div className="col-span-12 lg:col-span-3 no-print">
                            <div className="bg-white rounded-[2rem] shadow-2xl border-t-[12px] border-blue-500 p-8 sticky top-6 min-h-[500px] flex flex-col">
                                {selectedRecipe ? (
                                    <div className="animate-in slide-in-from-bottom-4 duration-300">
                                        <div className="mb-8">
                                            <span className="text-[10px] font-black text-blue-500 uppercase tracking-widest bg-blue-50 px-3 py-1 rounded-full">ìƒì„¸ ë‚´ìš©</span>
                                            <h2 className="text-2xl font-black text-slate-900 mt-4 leading-tight border-b pb-4">ë ˆì‹œí”¼ ìƒì„¸ë³´ê¸°</h2>
                                        </div>
                                        
                                        <div className="bg-slate-50 p-6 rounded-3xl text-slate-800 leading-relaxed whitespace-pre-wrap text-lg font-medium shadow-inner border border-slate-100">
                                            {selectedRecipe}
                                        </div>

                                        <div className="mt-10 p-5 bg-yellow-50 rounded-2xl border border-yellow-100">
                                            <p className="text-xs text-yellow-700 leading-5">
                                                <strong className="block mb-1">ğŸ’¡ ì…°í”„ë‹˜ì„ ìœ„í•œ ì•ˆë‚´</strong>
                                                ì—‘ì…€ ì…€ ì•ˆì— ì íŒ ë©”ë‰´ëª…, ì¡°ë¦¬ë²•, ì˜ì–‘ì„±ë¶„ì´ ìœ„ ì°½ì— ëª¨ë‘ í‘œì‹œë©ë‹ˆë‹¤. ì¸ì‡„ ì‹œì—ëŠ” ì™¼ìª½ì˜ ì‹ë‹¨í‘œê°€ ê°•ì¡°ë©ë‹ˆë‹¤.
                                            </p>
                                        </div>
                                    </div>
                                ) : (
                                    <div className="h-full flex flex-col items-center justify-center text-center text-slate-300 py-20 flex-grow">
                                        <div className="text-5xl mb-6">ğŸ”</div>
                                        <p className="font-bold text-lg">ì™¼ìª½ ì‹ë‹¨í‘œì—ì„œ<br/>ì¹¸ì„ í´ë¦­í•´ ë³´ì„¸ìš”.</p>
                                        <p className="text-xs mt-2 text-slate-400 font-normal underline decoration-dotted">í´ë¦­í•œ ë‚´ìš©ì´ í¬ê²Œ ë³´ì…ë‹ˆë‹¤.</p>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                    
                    {/* ì¸ì‡„ ì‹œ í•˜ë‹¨ ì •ë³´ í‘œì‹œ */}
                    <footer className="print-only hidden p-10 text-center text-slate-400 text-sm italic">
                        ë¯¸ì†Œì—° MMS ìŠ¤ë§ˆíŠ¸ ì‹ë‹¨ ê´€ë¦¬ ì‹œìŠ¤í…œìœ¼ë¡œ ìƒì„±ëœ ë¬¸ì„œì…ë‹ˆë‹¤.
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MisoYonApp />);
    </script>
</body>
</html>
