<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÎØ∏ÏÜåÏó∞ Î†àÏãúÌîº & ÏãùÎã® Í¥ÄÎ¶¨ v1.4</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body class="bg-gray-100">
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useMemo } = React;

        const MisoYonApp = () => {
            const [viewMode, setViewMode] = useState('daily'); // daily, weekly, monthly
            const [menuData, setMenuData] = useState([]); // Ï†ÑÏ≤¥ Î©îÎâ¥/Î†àÏãúÌîº Îç∞Ïù¥ÌÑ∞
            const [selectedRecipe, setSelectedRecipe] = useState(null); // ÏÉÅÏÑ∏Î≥¥Í∏∞Ïö©
            const [searchTerm, setSearchTerm] = useState("");

            // ÏóëÏÖÄ Îç∞Ïù¥ÌÑ∞ ÌååÏã± (ÏÖ∞ÌîÑÎãò ÌååÏùº Íµ¨Ï°∞ ÎåÄÏùë)
            const handleFile = (e) => {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = (evt) => {
                    const wb = XLSX.read(evt.target.result, { type: 'binary' });
                    const raw = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]);
                    // Î†àÏãúÌîº ÌòïÏãùÏúºÎ°ú Í∞ÄÍ≥µ (Îç∞Ïù¥ÌÑ∞Ïóê Î†àÏãúÌîº ÎÇ¥Ïö©Ïù¥ Ìè¨Ìï®ÎêòÏñ¥ ÏûàÎã§Í≥† Í∞ÄÏ†ï)
                    const processed = raw.map((item, idx) => ({
                        id: idx,
                        date: item['ÏùºÏûê'] || 'ÎÇ†ÏßúÎØ∏ÏÉÅ',
                        type: item['Íµ¨Î∂Ñ'] || 'ÏùºÎ∞ò',
                        name: item['Î©îÎâ¥Î™Ö'] || item['Î©îÎâ¥'] || 'Ïù¥Î¶ÑÏóÜÏùå',
                        recipe: item['Î†àÏãúÌîº'] || item['Ï°∞Î¶¨Î≤ï'] || 'Îì±Î°ùÎêú Î†àÏãúÌîº ÎÇ¥Ïö©Ïù¥ ÏóÜÏäµÎãàÎã§.',
                        nutrition: item['ÏòÅÏñëÏÑ±Î∂Ñ'] || 'Í∏∞Î°ù ÏóÜÏùå',
                        week: item['Ï£ºÏ∞®'] || '1Ï£ºÏ∞®'
                    }));
                    setMenuData(processed);
                };
                reader.readAsBinaryString(file);
            };

            const filteredList = useMemo(() => {
                return menuData.filter(m => m.name.includes(searchTerm) || m.date.includes(searchTerm));
            }, [menuData, searchTerm]);

            return (
                <div className="min-h-screen flex flex-col">
                    {/* ÏÉÅÎã®Î∞î: Í≤ÄÏÉâ Î∞è Î™®Îìú Ï†ÑÌôò */}
                    <header className="bg-slate-900 text-white p-4 sticky top-0 z-20 no-print">
                        <div className="max-w-7xl mx-auto flex flex-wrap gap-4 justify-between items-center">
                            <div className="flex items-center gap-4">
                                <h1 className="text-xl font-black tracking-tighter text-blue-400">MISOYON v1.4</h1>
                                <div className="flex bg-slate-800 rounded-lg p-1">
                                    {['daily', 'weekly', 'monthly'].map(mode => (
                                        <button 
                                            key={mode}
                                            onClick={() => setViewMode(mode)}
                                            className={`px-4 py-1.5 rounded-md text-xs font-bold transition ${viewMode === mode ? 'bg-blue-600 text-white' : 'text-slate-400'}`}
                                        >
                                            {mode.toUpperCase()}
                                        </button>
                                    ))}
                                </div>
                            </div>
                            
                            <div className="flex-grow max-w-md relative">
                                <input 
                                    type="text" 
                                    placeholder="ÎÇ†Ïßú ÎòêÎäî Î©îÎâ¥Î™Ö Ïä§ÎßàÌä∏ Í≤ÄÏÉâ..." 
                                    className="w-full bg-slate-800 border-none rounded-xl px-4 py-2 text-sm focus:ring-2 ring-blue-500"
                                    onChange={(e) => setSearchTerm(e.target.value)}
                                />
                            </div>

                            <label className="bg-blue-600 hover:bg-blue-500 px-4 py-2 rounded-xl text-xs font-bold cursor-pointer transition">
                                ÌååÏùº ÏóÖÎç∞Ïù¥Ìä∏
                                <input type="file" onChange={handleFile} className="hidden" />
                            </label>
                        </div>
                    </header>

                    <div className="max-w-7xl mx-auto w-full p-6 grid grid-cols-1 lg:grid-cols-12 gap-6">
                        {/* ÏôºÏ™Ω: Î©îÎâ¥ Î™©Î°ù (ÏùºÍ∞Ñ/Ï£ºÍ∞Ñ/ÏõîÍ∞Ñ Î¶¨Ïä§Ìä∏) */}
                        <main className="lg:col-span-8">
                            <div className="bg-white rounded-3xl shadow-sm border p-6 min-h-[70vh]">
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-2xl font-black text-slate-800 capitalize">{viewMode} Menu List</h2>
                                    <button onClick={() => window.print()} className="text-sm font-bold text-blue-600 underline">ÌòÑÏû¨ ÌôîÎ©¥ Ï∂úÎ†•/Ï†ÄÏû•</button>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    {filteredList.map(m => (
                                        <div 
                                            key={m.id} 
                                            onClick={() => setSelectedRecipe(m)}
                                            className="p-5 border rounded-2xl hover:border-blue-500 hover:bg-blue-50 cursor-pointer transition group"
                                        >
                                            <div className="flex justify-between items-start mb-2">
                                                <span className="text-[10px] font-bold bg-slate-100 px-2 py-1 rounded text-slate-500">{m.date} | {m.type}</span>
                                            </div>
                                            <h3 className="text-lg font-bold text-slate-800 group-hover:text-blue-600">{m.name}</h3>
                                            <p className="text-xs text-slate-400 mt-2 line-clamp-1">{m.recipe}</p>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </main>

                        {/* Ïò§Î•∏Ï™Ω: Î†àÏãúÌîº ÏÉÅÏÑ∏Î≥¥Í∏∞ Ìå®ÎÑê */}
                        <aside className="lg:col-span-4 no-print">
                            <div className="bg-white rounded-3xl shadow-xl border border-blue-100 p-8 sticky top-24 min-h-[500px]">
                                {selectedRecipe ? (
                                    <div className="animate-in fade-in duration-300">
                                        <h2 className="text-2xl font-black text-slate-900 mb-2">{selectedRecipe.name}</h2>
                                        <div className="flex gap-2 mb-6">
                                            <span className="text-xs font-bold bg-blue-100 text-blue-600 px-3 py-1 rounded-full">ÏòÅÏñëÏÑ±Î∂Ñ Ìè¨Ìï®</span>
                                        </div>
                                        
                                        <div className="space-y-6">
                                            <section>
                                                <h4 className="text-xs font-bold text-slate-400 uppercase tracking-widest mb-2 border-b pb-1">Cooking Recipe</h4>
                                                <div className="text-slate-700 leading-relaxed whitespace-pre-wrap text-sm bg-slate-50 p-4 rounded-2xl">
                                                    {selectedRecipe.recipe}
                                                </div>
                                            </section>

                                            <section>
                                                <h4 className="text-xs font-bold text-slate-400 uppercase tracking-widest mb-2 border-b pb-1">Nutrition Info</h4>
                                                <div className="text-sm font-bold text-blue-600 bg-blue-50 p-4 rounded-2xl">
                                                    {selectedRecipe.nutrition}
                                                </div>
                                            </section>
                                        </div>
                                    </div>
                                ) : (
                                    <div className="h-full flex flex-col items-center justify-center text-slate-300 text-center py-20">
                                        <div className="text-4xl mb-4">üìñ</div>
                                        <p className="font-bold">Î©îÎâ¥Î•º ÏÑ†ÌÉùÌïòÎ©¥<br/>ÏÉÅÏÑ∏ Î†àÏãúÌîºÍ∞Ä ÎÇòÌÉÄÎÇ©ÎãàÎã§.</p>
                                    </div>
                                )}
                            </div>
                        </aside>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MisoYonApp />);
    </script>
</body>
</html>
